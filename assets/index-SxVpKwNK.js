(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();class c{navContainer;navHeader;navControls;algorithmOptions=[{value:"BFS",label:"Breadth-First Search (BFS)"},{value:"DFS",label:"Depth-First Search (DFS)"},{value:"Dijkstra",label:"Dijkstra's Algorithm"},{value:"A*",label:"A* Search Algorithm"}];constructor(t){const e=document.getElementById(t);if(!e)throw new Error(`Container with id ${t} not found`);this.navContainer=e,this.navHeader=this.initHeader(),this.navControls=this.initControls()}initialize(){this.navContainer.innerHTML="",this.navContainer.appendChild(this.navHeader),this.navContainer.appendChild(this.navControls),this.render()}initHeader(){const t=document.createElement("div");return t.classList.add("nav-header"),t}initControls(){const t=document.createElement("div");return t.classList.add("nav-controls"),t}renderHeader(){this.navHeader.innerHTML='<a href="#">SmartPath Visualizer</a>'}renderControls(){this.navControls.innerHTML=`
    <div class="algorithm">
        <label for="algorithm" class="combobox-label">Algorithm:</label>
        <select>
          ${this.algorithmOptions.map(t=>`<option value="${t.value}">${t.label}</option>`).join("")}
        </select> 
    </div>
    <div class="action">
      <button class="clear-walls btn btn-clear">
        Clear Walls
      </button>
      <button class="clear-path btn btn-clear">
        Clear Path
      </button>
      <button class="visualize btn btn-start">
        Visualize
      </button>
    </div>
    `}render(){this.renderHeader(),this.renderControls()}getAlgorithmOptions(){return this.algorithmOptions}getAlgorithmSelectElement(){return this.navControls.querySelector(".algorithm select")}getVisualizeButton(){return this.navControls.querySelector(".visualize")}getClearWallsButton(){return this.navControls.querySelector(".clear-walls")}getClearPathButton(){return this.navControls.querySelector(".clear-path")}}class g{rowCount=35;colCount=80;gridContainer;gridBoard;constructor(t){const e=document.getElementById(t);if(!e)throw new Error(`Container with id ${t} not found`);this.gridContainer=e,this.gridBoard=this.initBoard()}initialize(){this.gridContainer.innerHTML="",this.gridContainer.appendChild(this.gridBoard),this.render()}initBoard(){const t=document.createElement("table");return t.classList.add("board"),t}renderBoard(t,e){const s=document.createElement("tbody");for(let i=0;i<t;i++){const n=document.createElement("tr");n.id=`row-${i}`;for(let o=0;o<e;o++){const r=document.createElement("td");r.id=`${i}-${o}`,r.classList.add("unvisited"),n.appendChild(r)}s.appendChild(n)}this.gridBoard.appendChild(s)}render(){this.renderBoard(this.rowCount,this.colCount)}getBoardElement(){return this.gridBoard}getNodeElement(t,e){return this.gridBoard.querySelector(`td[id="${t}-${e}"]`)}updateNodeClass(t,e){t.className="",this.addNodeClass(t,e)}addNodeClass(t,e){t.classList.add(e)}removeNodeClass(t,e){t.classList.remove(e)}}class v{view;isVisualizing=!1;constructor(t){this.view=t,this.view.initialize()}toggleButton(){const t=this.view.getVisualizeButton();t.classList.contains("btn-start")?(t.classList.remove("btn-start"),t.classList.add("btn-stop"),t.textContent="Stop Visualizing",this.isVisualizing=!0):(t.classList.remove("btn-stop"),t.classList.add("btn-start"),t.textContent="Visualize",this.isVisualizing=!1)}buttonDisabled(t){this.view.getClearPathButton().disabled=t,this.view.getClearWallsButton().disabled=t}handleVisualize(t,e){this.view.getVisualizeButton().addEventListener("click",async()=>{if(this.toggleButton(),this.isVisualizing){this.buttonDisabled(!0);const i=this.view.getAlgorithmSelectElement().value;await t(i),this.isVisualizing&&this.toggleButton(),this.buttonDisabled(!1)}else e()})}handleClearWalls(t){this.view.getClearWallsButton().addEventListener("click",()=>{this.isVisualizing||t()})}handleClearPath(t){this.view.getClearPathButton().addEventListener("click",()=>{this.isVisualizing||t()})}getIsVisualizing(){return this.isVisualizing}}class m{row;col;isWall=!1;isStart=!1;isEnd=!1;distance=1/0;heuristic=0;previous=null;constructor(t,e){this.row=t,this.col=e}getRow(){return this.row}getCol(){return this.col}setWall(t){this.isWall=t}getIsWall(){return this.isWall}setStart(t){this.isStart=t}getIsStart(){return this.isStart}setEnd(t){this.isEnd=t}getIsEnd(){return this.isEnd}setDistance(t){this.distance=t}getDistance(){return this.distance}setHeuristic(t){this.heuristic=t}getHeuristic(){return this.heuristic}setPrevious(t){this.previous=t}getPrevious(){return this.previous}}class f{nodes;numRows;numCols;constructor(t,e){this.numRows=t,this.numCols=e,this.nodes=[],this.initializeMatrix()}initializeMatrix(){for(let t=0;t<this.numRows;t++){const e=[];for(let s=0;s<this.numCols;s++)e.push(new m(t,s));this.nodes.push(e)}}getNode(t,e){return this.nodes[t][e]}getNumRows(){return this.numRows}getNumCols(){return this.numCols}}class u{getNeighbors(t,e){const s=[[0,1],[1,0],[0,-1],[-1,0]],i=[];for(const[n,o]of s){const r=t.getRow()+n,a=t.getCol()+o;if(r>=0&&a>=0&&r<e.getNumRows()&&a<e.getNumCols()){const d=e.getNode(r,a);d.getIsWall()||i.push(d)}}return i}reconstructPath(t){const e=[];let s=t;for(;s;)e.unshift(s),s=s.getPrevious();return e}}class w extends u{findPath(t,e,s){const i=[e],n=new Set([e]),o=[];for(;i.length>0;){const r=i.shift();if(o.push(r),r===s)return{visitedNodesInOrder:o,shortestPath:this.reconstructPath(s)};for(const a of this.getNeighbors(r,t))n.has(a)||(n.add(a),a.setPrevious(r),i.push(a))}return{visitedNodesInOrder:o,shortestPath:[]}}}class C extends u{findPath(t,e,s){const i=[e],n=new Set([e]),o=[];for(;i.length>0;){const r=i.pop();if(o.push(r),r===s)return{visitedNodesInOrder:o,shortestPath:this.reconstructPath(s)};for(const a of this.getNeighbors(r,t))n.has(a)||(n.add(a),a.setPrevious(r),i.push(a))}return{visitedNodesInOrder:o,shortestPath:[]}}}class N extends u{findPath(t,e,s){const i=[];e.setDistance(0);const n=[];for(let o=0;o<t.getNumRows();o++)for(let r=0;r<t.getNumCols();r++)n.push(t.getNode(o,r));for(;n.length>0;){n.sort((r,a)=>r.getDistance()-a.getDistance());const o=n.shift();if(!o.getIsWall()){if(o.getDistance()===1/0)break;if(i.push(o),o===s)return{visitedNodesInOrder:i,shortestPath:this.reconstructPath(s)};for(const r of this.getNeighbors(o,t)){const a=o.getDistance()+1;a<r.getDistance()&&(r.setDistance(a),r.setPrevious(o))}}}return{visitedNodesInOrder:i,shortestPath:[]}}}class p extends u{heuristic(t,e){return Math.abs(t.getRow()-e.getRow())+Math.abs(t.getCol()-e.getCol())}findPath(t,e,s){const i=[e],n=[],o=new Map([[e,0]]),r=new Map([[e,this.heuristic(e,s)]]);for(;i.length>0;){i.sort((d,h)=>(r.get(d)??1/0)-(r.get(h)??1/0));const a=i.shift();if(n.push(a),a===s)return{visitedNodesInOrder:n,shortestPath:this.reconstructPath(s)};for(const d of this.getNeighbors(a,t)){const h=(o.get(a)??1/0)+1;h<(o.get(d)??1/0)&&(d.setPrevious(a),o.set(d,h),r.set(d,h+this.heuristic(d,s)),i.includes(d)||i.push(d))}}return{visitedNodesInOrder:n,shortestPath:[]}}}class b{static create(t){switch(t){case"BFS":return new w;case"DFS":return new C;case"Dijkstra":return new N;case"A*":return new p;default:throw new Error(`Thuật toán '${t}' không được hỗ trợ.`)}}}class P{model;view;startNode=null;endNode=null;isMousePressed=!1;isVisualization=!1;constructor(t){this.view=t,this.model=new f(t.rowCount,t.colCount),this.view.initialize(),this.setupHandlers(),this.initializeStartEndNodes()}initializeStartEndNodes(){const t={row:15,col:30},e={row:15,col:50};this.startNode=this.model.getNode(t.row,t.col),this.startNode.setStart(!0),this.endNode=this.model.getNode(e.row,e.col),this.endNode.setEnd(!0),this.view.updateNodeClass(this.view.getNodeElement(t.row,t.col),"start"),this.view.updateNodeClass(this.view.getNodeElement(e.row,e.col),"end")}setupHandlers(){const t=this.view.getBoardElement();t.addEventListener("mousedown",e=>this.handleMouseDown(e)),t.addEventListener("mouseenter",e=>this.handleMouseEnter(e)),t.addEventListener("mouseup",()=>this.handleMouseUp())}handleMouseDown(t){if(this.isVisualization)return;const e=t.target;if(e.tagName==="TD"){const[s,i]=e.id.split("-").map(Number),n=this.model.getNode(s,i);!n.getIsStart()&&!n.getIsEnd()&&(this.isMousePressed=!0,this.toggleWall(n,e))}}handleMouseEnter(t){if(!this.isMousePressed||this.isVisualization)return;const e=t.target;if(e.tagName==="TD"){const[s,i]=e.id.split("-").map(Number),n=this.model.getNode(s,i);!n.getIsStart()&&!n.getIsEnd()&&this.toggleWall(n,e)}}handleMouseUp(){this.isMousePressed=!1}toggleWall(t,e){const s=!t.getIsWall();t.setWall(s),this.view.updateNodeClass(e,s?"wall":"unvisited")}async visualize(t){if(this.isVisualization||!this.startNode||!this.endNode)return;this.clearBoard(),this.isVisualization=!0;const s=b.create(t).findPath(this.model,this.startNode,this.endNode);await this.animateVisitedNodes(s.visitedNodesInOrder),s.shortestPath.length>0&&await this.animateShortestPath(s.shortestPath),this.isVisualization=!1}async animateVisitedNodes(t){for(let e=0;e<t.length;e++){if(this.isVisualization===!1)return;await this.delay(10);const s=t[e],i=this.view.getNodeElement(s.getRow(),s.getCol());!s.getIsStart()&&!s.getIsEnd()?this.view.updateNodeClass(i,"visited"):(this.view.removeNodeClass(i,"unvisited"),this.view.addNodeClass(i,"visited"))}}async animateShortestPath(t){for(let e=0;e<t.length;e++){if(this.isVisualization===!1)return;await this.delay(50);const s=t[e],i=this.view.getNodeElement(s.getRow(),s.getCol());!s.getIsStart()&&!s.getIsEnd()?this.view.updateNodeClass(i,"shortest-path"):(this.view.removeNodeClass(i,"visited"),this.view.addNodeClass(i,"shortest-path"))}}clearWalls(){for(let t=0;t<this.model.getNumRows();t++)for(let e=0;e<this.model.getNumCols();e++){const s=this.model.getNode(t,e),i=this.view.getNodeElement(t,e);s.getIsWall()&&(s.setWall(!1),this.view.updateNodeClass(i,"unvisited"))}}clearPath(){for(let t=0;t<this.model.getNumRows();t++)for(let e=0;e<this.model.getNumCols();e++){const s=this.model.getNode(t,e),i=this.view.getNodeElement(t,e);s.setDistance(1/0),s.setHeuristic(0),s.setPrevious(null),s.getIsWall()||(this.view.removeNodeClass(i,"visited"),this.view.removeNodeClass(i,"shortest-path"),this.view.addNodeClass(i,"unvisited"))}}clearBoard(){this.clearPath()}setIsVisualization(t){this.isVisualization=t}getIsVisualization(){return this.isVisualization}getModel(){return this.model}delay(t){return new Promise(e=>setTimeout(e,t))}}document.querySelector("#app").innerHTML=`
<nav id="nav-container"></nav>
<div id="grid-container"></div>
`;document.addEventListener("DOMContentLoaded",()=>{const l=new c("nav-container"),t=new v(l),e=new g("grid-container"),s=new P(e);t.handleVisualize(i=>s.visualize(i),()=>{s.setIsVisualization(!1)}),t.handleClearWalls(()=>{s.getIsVisualization()||s.clearWalls()}),t.handleClearPath(()=>{s.getIsVisualization()||s.clearPath()})});
